<h2>Cool cats near me <%= @maps_api_key%>
</h2>


<style>
    html, body {
        margin: 0;
        padding: 0;
        height: 100%;
    }
    #map {
        height: 100%;
    }
</style>

<div id="map"></div>


<script>

    const users = <%= @users.to_json.html_safe %>;

    function initMap() {

        // Create a bounding box object
        var bounds = new google.maps.LatLngBounds();

        var map = new google.maps.Map(document.getElementById('map'), {
            // zoom: 12,
            // center: { lat: users[0].latitude, lng: users[0].longitude }
        });

        for (let i = 0; i < users.length; i++) {
            const user = users[i];

            var marker = new google.maps.Marker({
                position: { lat: user.latitude, lng: user.longitude },
                map: map,
                title: user.name
            });

            // Add the latest marker to bounding box
            bounds.extend( marker.position )

        }   //end of for loop

        // Make the map fit within the box containing the bounds
        map.fitBounds( bounds );

    }   //end of initMap
</script>


<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=#{ @maps_api_key }&callback=initMap">
</script>